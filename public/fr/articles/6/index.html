<!DOCTYPE html>
<html lang="fr" dir="fr">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Les 10 optimales workflows Argo; avec examples. | Logistique Dataware</title>
<meta name="keywords" content="Kubernetes, Argo, Development, Infrastructure Observability">
<meta name="description" content="Bonjour √† tous,
Nous savons tous comment Argo Workflows permet d&rsquo;orchestrer facilement des travaux parall√®les sur Kubernetes. Bien qu&rsquo;il soit le plus souvent associ√© aux projets de traitement de donn√©es et d&rsquo;ETL, il est utile pour bien d&rsquo;autres choses ! Ces 10 workflows vont changer la fa√ßon dont vous voyez cet orchestrateur Kubernetes.
Allons-y !
Configuration des Workflows Argo
Si vous n&rsquo;avez pas actuellement de workflow en cours d&rsquo;ex√©cution, je vous sugg√®re de cr√©er votre premier Argo Workflow pour comprendre ce dont nous allons parler dans ce post.">
<meta name="author" content="Daniel Paes">
<link rel="canonical" href="https://pipekit.io/blog/top-10-argo-workflows-examples">
<meta name="google-site-verification" content="4599922566">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.dawrlog.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.dawrlog.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.dawrlog.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.dawrlog.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.dawrlog.com/apple-touch-icon.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="fr" href="https://www.dawrlog.com/fr/articles/6/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Les 10 optimales workflows Argo; avec examples." />
<meta property="og:description" content="Bonjour √† tous,
Nous savons tous comment Argo Workflows permet d&rsquo;orchestrer facilement des travaux parall√®les sur Kubernetes. Bien qu&rsquo;il soit le plus souvent associ√© aux projets de traitement de donn√©es et d&rsquo;ETL, il est utile pour bien d&rsquo;autres choses ! Ces 10 workflows vont changer la fa√ßon dont vous voyez cet orchestrateur Kubernetes.
Allons-y !
Configuration des Workflows Argo
Si vous n&rsquo;avez pas actuellement de workflow en cours d&rsquo;ex√©cution, je vous sugg√®re de cr√©er votre premier Argo Workflow pour comprendre ce dont nous allons parler dans ce post." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.dawrlog.com/fr/articles/6/" />
<meta property="og:image" content="https://user-images.githubusercontent.com/78096758/217081520-1f3b6771-8cf8-434b-b8fe-d11c17d380b5.png" /><meta property="article:section" content="articles" />
<meta property="article:published_time" content="2022-07-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-07-12T00:00:00+00:00" /><meta property="og:site_name" content="Logistique Dataware" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://user-images.githubusercontent.com/78096758/217081520-1f3b6771-8cf8-434b-b8fe-d11c17d380b5.png" />
<meta name="twitter:title" content="Les 10 optimales workflows Argo; avec examples."/>
<meta name="twitter:description" content="Bonjour √† tous,
Nous savons tous comment Argo Workflows permet d&rsquo;orchestrer facilement des travaux parall√®les sur Kubernetes. Bien qu&rsquo;il soit le plus souvent associ√© aux projets de traitement de donn√©es et d&rsquo;ETL, il est utile pour bien d&rsquo;autres choses ! Ces 10 workflows vont changer la fa√ßon dont vous voyez cet orchestrateur Kubernetes.
Allons-y !
Configuration des Workflows Argo
Si vous n&rsquo;avez pas actuellement de workflow en cours d&rsquo;ex√©cution, je vous sugg√®re de cr√©er votre premier Argo Workflow pour comprendre ce dont nous allons parler dans ce post."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Articles",
      "item": "https://www.dawrlog.com/fr/articles/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Les 10 optimales workflows Argo; avec examples.",
      "item": "https://www.dawrlog.com/fr/articles/6/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Les 10 optimales workflows Argo; avec examples.",
  "name": "Les 10 optimales workflows Argo; avec examples.",
  "description": "Bonjour √† tous,\nNous savons tous comment Argo Workflows permet d\u0026rsquo;orchestrer facilement des travaux parall√®les sur Kubernetes. Bien qu\u0026rsquo;il soit le plus souvent associ√© aux projets de traitement de donn√©es et d\u0026rsquo;ETL, il est utile pour bien d\u0026rsquo;autres choses ! Ces 10 workflows vont changer la fa√ßon dont vous voyez cet orchestrateur Kubernetes.\nAllons-y !\nConfiguration des Workflows Argo\nSi vous n\u0026rsquo;avez pas actuellement de workflow en cours d\u0026rsquo;ex√©cution, je vous sugg√®re de cr√©er votre premier Argo Workflow pour comprendre ce dont nous allons parler dans ce post.",
  "keywords": [
    "Kubernetes", "Argo", "Development", "Infrastructure Observability"
  ],
  "articleBody": "Bonjour √† tous,\nNous savons tous comment Argo Workflows permet d‚Äôorchestrer facilement des travaux parall√®les sur Kubernetes. Bien qu‚Äôil soit le plus souvent associ√© aux projets de traitement de donn√©es et d‚ÄôETL, il est utile pour bien d‚Äôautres choses ! Ces 10 workflows vont changer la fa√ßon dont vous voyez cet orchestrateur Kubernetes.\nAllons-y !\nConfiguration des Workflows Argo\nSi vous n‚Äôavez pas actuellement de workflow en cours d‚Äôex√©cution, je vous sugg√®re de cr√©er votre premier Argo Workflow pour comprendre ce dont nous allons parler dans ce post. Pour ce faire, suivez les instructions ici pour cr√©er un d√©ploiement local de Workflows Argo sur votre cluster. Je vous sugg√®re √©galement d‚Äôutiliser k3d pour votre plan de contr√¥le Kubernetes local ; ce tutoriel utilise un cluster k3d nomm√© argo. N‚Äôh√©sitez pas √† reproduire la commande ci-dessous pour le cr√©er dans votre environnement :\nk3d cluster create argo kubectl create -n argo -f https://raw.githubusercontent.com/argoproj/argo-workflows/master/manifests/quick-start-postgres.yaml kubectl -n argo port-forward deployment/argo-server 2746:2746 \u0026 Maintenant, regardons notre premier exemple !\n1. Am√©liorer votre flux de travail √† l‚Äôaide de param√®tres\nArgo utilise des custom resource definitions stock√©es dans des fichiers YAML pour g√©rer ses d√©ploiements. Il n‚Äôest donc pas n√©cessaire d‚Äôapprendre de nouvelles sp√©cifications pour g√©rer votre infrastructure ; vous pouvez suivre le m√™me mod√®le que celui utilis√© sur vos scripts Kubernetes et Kustomize, ce qui vous aide √† rester coh√©rent. Ci-dessous, nous pouvons voir comment utiliser les param√®tres sur vos workflows, et passer des param√®tres est pratique lorsque votre configuration utilise des valeurs d‚Äôex√©cution. Par cons√©quent, vous ne conna√Ætrez certains composants qu‚Äôapr√®s les avoir cr√©√©s, comme les jetons d‚Äôacc√®s.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: hello-world-parameters- spec: entrypoint: whalesay arguments: parameters: - name: message value: Message string default value templates: - name: whalesay inputs: parameters: - name: message container: image: docker/whalesay command: [cowsay] args: [\"{{inputs.parameters.message}}\"] Dans notre mod√®le, le param√®tre message aura la valeur par d√©faut de Message string default value. Cependant, cette valeur peut √™tre √©cras√©e au moment de l‚Äôex√©cution, comme nous pouvons le voir en ex√©cutant la commande ci-dessous :\nargo submit -n argo param.yml -p message=\"This ran from your container\" --watch Nous pouvons valider la sortie √† partir de l‚Äôinterface utilisateur des logs des workflows Argo. (Vous pouvez acc√©der √† l‚ÄôIU par d√©faut √† https://localhost:2746/ si vous suivez rapidement les instructions de transfert de port lors de la cr√©ation de votre cluster).\n2. Extraire des images de votre r√©f√©rentiel s√©curis√©\nL‚Äôune des fonctionnalit√©s que j‚Äôappr√©cie lors de l‚Äôautomatisation d‚Äôun √©cosyst√®me est l‚Äôutilisation de cl√©s d‚Äôacc√®s rotatives tout en g√©rant l‚Äôacc√®s de mes services. Ceci est utile dans les cas o√π votre entreprise utilise des d√©p√¥ts de conteneurs priv√©s pour h√©berger vos images de conteneurs. Les workflows Argo vous aident √† r√©aliser cela gr√¢ce au support natif des secrets Kubernetes. Dans notre exemple, nous pouvons voir que le secret docker-registry-secret va tirer l‚Äôimage docker/whalesay:latest.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: hello-world- spec: entrypoint: whalesay imagePullSecrets: - name: docker-registry-secret templates: - name: whalesay container: image: docker/whalesay:latest command: [cowsay] args: [\"hello world\"] 3. Utilisation des conteneurs Sidecar L‚Äôune de mes choses pr√©f√©r√©es √† faire est d‚Äôutiliser des sidecars lors du d√©marrage de mes pods. Les sidecars Kubernetes sont des aides utiles qui peuvent g√©rer des t√¢ches r√©currentes, comme la synchronisation de vos d√©p√¥ts Git avec git-sync comme indiqu√© ici. Les flux de travail d‚ÄôArgo couvrent ce probl√®me avec un support soign√© des conteneurs sidecars.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: sidecar-nginx- spec: entrypoint: sidecar-nginx-example templates: - name: sidecar-nginx-example container: image: appropriate/curl command: [sh, -c] args: [\"until `curl -G 'http://127.0.0.1/' \u003e\u0026 /tmp/out`; do echo sleep \u0026\u0026 sleep 1; done \u0026\u0026 cat /tmp/out\"] sidecars: - name: nginx image: nginx:1.13 Pour le d√©ployer, enregistrez le code ci-dessus sous le nom de sidecar-nginx.yml et soumettez-le :\nargo submit -n argo sidecar-nginx.yml --watch Et comme r√©sultat, vous allez d√©ployer une instance sidecar de proxy inverse de NGINX.\nPro-tip : Vous devrez peut-√™tre pr√™ter une attention particuli√®re √† vos workflows si vous utilisez Istio comme Service mesh. Consultez ce fil de discussion GitHub si vous envisagez de l‚Äôutiliser.\n4. Archiver l‚Äô√©tat actuel de votre workflow sur un stockage persistant\nL‚Äôarchivage des workflows est une fonctionnalit√© int√©ressante fournie par Argo Workflows afin que vous puissiez avoir des √©tats de workflow pr√©c√©dents stock√©s sur une base de donn√©es relationnelle (Postgres ou MySQL pour l‚Äôinstant). Cependant, l‚Äôarchive d‚ÄôArgo ne conservera pas les journaux d‚Äôex√©cution d√©taill√©s ; vous devrez configurer un stockage d‚Äôobjets comme artefact repository, il peut s‚Äôagir d‚Äôune option opensource comme MinIO, ou AWS S3 ; pour mentionner une option de fournisseur de cloud d‚ÄôAWS.\nPour utiliser la fonctionnalit√© d‚Äôarchivage, vous devez d‚Äôabord configurer l‚Äôoption de stockage persistant de votre serveur Argo. Pour ce faire, vous aurez besoin de plus d‚Äôinformations sur la fa√ßon de la configurer. En suivant ce lien, vous pourrez vous familiariser avec les √©l√©ments d‚Äôauthentification requis pour l‚Äôarchive Argo ; puis, basez votre configuration sur Controller configmap. Vous devrez les avoir configur√©s de mani√®re appropri√©e avec votre serveur Argo pour b√©n√©ficier de cette fonctionnalit√©. Une fois qu‚Äôil est configur√©, vous pouvez stocker vos flux de travail avec le spec.archiveLocation.archiveLogs comme d√©montr√© ci-dessous.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: archive-location- spec: entrypoint: whalesay templates: - name: whalesay container: image: docker/whalesay:latest command: [cowsay] args: [\"hello world\"] archiveLocation: archiveLogs: true 5. Passer un d√©p√¥t Git comme artefact d‚Äôentr√©e\nUne autre fonctionnalit√© int√©ressante fournie par Argo Workflows est la possibilit√© de synchroniser votre d√©p√¥t Git sans avoir besoin de sidecars ou de conteneurs init suppl√©mentaires. Le code ci-dessous se connecte au d√©p√¥t Argo sur Github. Vous pouvez choisir entre des demandes de pull HTTP ou SSH pour l‚Äô√©l√©ment d‚Äôauthentification. Dans le premier mod√®le, git-clone, vous devrez utiliser la combinaison des secrets Kubernetes usernameSecret et passwordSecret pour acc√©der √† une URL dans son format HTTP. Vous pouvez voir un exemple de configuration HTTP de Git dans le code ci-dessous.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: input-artifact-git- spec: entrypoint: git-clone templates: - name: git-clone inputs: artifacts: - name: argo-source path: /src git: repo: https://github.com/argoproj/argo-workflows.git revision: \"v2.1.1\" usernameSecret: name: github-creds key: username passwordSecret: name: github-creds key: password container: image: golang:1.10 command: [sh, -c] args: [\"git status \u0026\u0026 ls \u0026\u0026 cat VERSION\"] workingDir: /src Argo Workflows supporte √©galement la connectivit√© SSH (e.g., git@github.com:argoproj/argo-workflows.git). Cependant, il a besoin du format d‚ÄôURL suivant la connectivit√© SSH et du secret Kubernetes sshPrivateKeySecret au lieu des secrets usernameSecret et passwordSecret. 6. cr√©ation de flux de travail de graphes acycliques dirig√©s\nJ‚Äôai l‚Äôimpression que le graphe acyclique dirig√© (DAG) re√ßoit maintenant l‚Äôattention qu‚Äôil m√©rite dans les domaines de l‚Äôanalyse en raison de la fa√ßon impressionnante dont il g√®re les √©tapes de la charge de travail de traitement des donn√©es sur Apache Spark et de son utilisation comme mod√®le commun d‚Äôorchestration des donn√©es avec Apache Airflow. Avec Argo Workflows, vous disposerez d‚Äôune interface conviviale Kubernetes au lieu de devoir configurer un ex√©cuteur Kubernetes pour Airflow qui est moins stable.\nJe vous sugg√®re de consulter ce lien pour en savoir plus sur le fonctionnement d‚Äôun DAG. Ci-dessous, vous pouvez voir comment Argo Workflows l‚Äôinstancie.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: dag-target- spec: entrypoint: dag-target arguments: parameters: - name: target value: E templates: - name: dag-target dag: target: \"{{workflow.parameters.target}}\" tasks: - name: A template: echo arguments: parameters: [{name: message, value: A}] - name: B depends: \"A\" template: echo arguments: parameters: [{name: message, value: B}] - name: C depends: \"A\" template: echo arguments: parameters: [{name: message, value: C}] - name: D depends: \"B \u0026\u0026 C\" template: echo arguments: parameters: [{name: message, value: D}] - name: E depends: \"C\" template: echo arguments: parameters: [{name: message, value: E}] - name: echo inputs: parameters: - name: message container: image: alpine:3.7 command: [echo, \"{{inputs.parameters.message}}\"] Chaque t√¢che sera pass√©e au serveur Argo en utilisant le nom du param√®tre target, avec les noms des cibles s√©par√©s par des espaces. Les workflows Argo n‚Äôex√©cuteront que celles que vous avez sp√©cifi√©es ; cependant, ils ex√©cuteront chaque d√©pendance jusqu‚Äô√† ce qu‚Äôelle atteigne les cibles renseign√©es. En clair, disons que nous enregistrons notre fichier sous le nom de dag-targets.yml et l‚Äôex√©cutons en utilisant la commande suivante :\nargo submit -n argo dag-targets.yml -p target=\"B E\" --watch Il ignorera uniquement la cible D, comme le montre la d√©monstration ci-dessous :\n7. ex√©cuter des scripts Python\nLes conteneurs facilitent d√©j√† la gestion des environnements d‚Äôex√©cution. Il est donc facile de construire un conteneur Python avec les biblioth√®ques et la version dont vous avez besoin pour vos √©tapes de workflow bas√©es sur Python.\nAvec les workflows Argo, vous pouvez appeler un script Python d√©j√† install√© sur le conteneur par son nom, ou passer du code via un champ source dans la description du workflow. Vous pouvez sp√©cifier n‚Äôimporte quel code valide dans le bloc source.\nVoici un exemple :\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: name: python-random-number-generator namespace: argo spec: entrypoint: generator arguments: parameters: - name: min value: 0 - name: max value: 10 templates: - name: generator inputs: parameters: - name: min - name: max script: image: python:3.8 command: [python] source: | from random import randrange range_min = {{inputs.parameters.min}} range_max = {{inputs.parameters.max}} random_number = randrange(range_min, range_max) print(\"Random number: {}\".format(random_number)) 8. impl√©mentation d‚Äôune strat√©gie de relance\nParfois, plusieurs cibles peuvent impl√©menter une certaine logique de relance, et Argo Workflows configure votre strat√©gie de relance au niveau du Workflow.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: retry-container- spec: entrypoint: retry-container templates: - name: retry-container retryStrategy: limit: \"3\" retryPolicy: \"OnError\" container: image: python:alpine3.6 command: [\"python\", -c] # fail with a 66% probability args: [\"import random; import sys; exit_code = random.choice([0, 1, 1]); sys.exit(exit_code)\"] Dans notre exemple, la cible retry-container essaiera de red√©marrer trois fois dans les cas o√π elle se termine avec un statut Error sur Kubernetes.\n9. Ajout de flux de travail conditionnels\nLes flux de travail conditionnels font √©galement partie de mes pr√©f√©r√©s et sont si simples √† mettre en ≈ìuvre. Vous pouvez d√©ployer votre architecture en fonction des √©tats de retour des √©tapes pr√©c√©dentes, ce qui est tr√®s pratique lorsque vous orchestrez un ensemble de conteneurs. Argo Workflows vous offre la possibilit√© d‚Äôex√©cuter des cibles bas√©es sur une condition bool√©enne. Sous le capot, il utilise govaluate pour vous permettre d‚Äôutiliser les instructions expr de Golang.\nVous serez donc en mesure d‚Äôorchestrer vos conditions de la m√™me mani√®re que vous g√©rez vos aides Golang dans votre √©cosyst√®me Kubernetes - un autre avantage suppl√©mentaire de l‚Äôutilisation des CRD Kubernetes.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: conditional-parameter- labels: workflows.argoproj.io/test: \"true\" annotations: workflows.argoproj.io/version: '\u003e= 3.1.0' spec: entrypoint: main templates: - name: main steps: - - name: flip-coin template: flip-coin - - name: heads template: heads when: \"{{steps.flip-coin.outputs.result}} == heads\" - name: tails template: tails when: \"{{steps.flip-coin.outputs.result}} == tails\" outputs: parameters: - name: stepresult valueFrom: expression: \"steps['flip-coin'].outputs.result == 'heads' ? steps.heads.outputs.result : steps.tails.outputs.result\" - name: flip-coin script: image: python:alpine3.6 command: [ python ] source: | import random print(\"heads\" if random.randint(0,1) == 0 else \"tails\") - name: heads script: image: python:alpine3.6 command: [ python ] source: | print(\"heads\") - name: tails script: image: python:alpine3.6 command: [ python ] source: | print(\"tails\") En enregistrant le code ci-dessus sous le nom de cond.yml et en l‚Äôex√©cutant avec argo submit, vous obtiendrez le r√©sultat suivant :\nargo submit -n argo cond.yml --watch 10. Gestion des ressources Kubernetes √† partir de votre flux de travail Les workflows Argo peuvent cr√©er des composants Kubernetes ; ceci est tr√®s pratique lorsque vous avez besoin de d√©velopper des actions kubelet temporaires de mani√®re d√©clarative. Cette fonctionnalit√© suit le m√™me principe que les scripts en ligne pour d√©ployer les composants Kubernetes responsables de l‚Äôapplication des correctifs √† votre environnement. Cependant, Argo Workflows g√®re les fichiers YAML en ligne de ce code Kubernetes CRD.\napiVersion: argoproj.io/v1alpha1 kind: Workflow metadata: generateName: k8s-jobs- spec: entrypoint: pi-tmpl templates: - name: pi-tmpl resource: action: create successCondition: status.succeeded \u003e 0 failureCondition: status.failed \u003e 3 manifest: | apiVersion: batch/v1 kind: Job metadata: generateName: pi-job- spec: template: metadata: name: pi spec: containers: - name: pi image: perl command: [\"perl\", \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"] restartPolicy: Never backoffLimit: 4 Cette fonctionnalit√© vous permet d‚Äôex√©cuter directement toutes les actions kubectl, ce qui vous permet de cr√©er/mettre √† jour/supprimer n‚Äôimporte quelle ressource Kubernetes sur votre cluster en utilisant les d√©finitions en ligne des groupes API Kubernetes.\nConclusion\nLes progr√®s r√©alis√©s dans la gestion et le d√©veloppement des syst√®mes nous donnent de nombreuses raisons d‚Äô√™tre optimistes. Par exemple, infrastructure as code vous permet d‚Äôavoir la m√™me infrastructure sur vos serveurs √©volutifs et sur votre poste de travail local. Des outils tels que Argo Workflows nous aident √† cr√©er une infrastructure √©volutive pr√™te √† √™tre mise en production sur notre poste de travail local, ce qui est en soi une bonne chose.\nAvec les changements constants des exigences de l‚Äôinfrastructure comme le DNS dynamique, vous devez adapter vos d√©ploiements √† une approche plus modulaire. Ces flux de travail sont les incontournables de tout administrateur DevOps. Mais cette liste n‚Äôest qu‚Äôun d√©but. Je vous conseille vivement de mettre en ≈ìuvre ces scripts dans vos pipelines de d√©veloppement et de donn√©es.\n√Ä+!\n",
  "wordCount" : "2143",
  "inLanguage": "fr",
  "image":"https://user-images.githubusercontent.com/78096758/217081520-1f3b6771-8cf8-434b-b8fe-d11c17d380b5.png","datePublished": "2022-07-12T00:00:00Z",
  "dateModified": "2022-07-12T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Daniel Paes"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.dawrlog.com/fr/articles/6/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Logistique Dataware",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.dawrlog.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.dawrlog.com/fr/" accesskey="h" title="Logistique Dataware (Alt + H)">Logistique Dataware</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://www.dawrlog.com/" title="English"
                            aria-label=":us:">üá∫üá∏</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.dawrlog.com/fr/apropos" title="√Ä Propos">
                    <span>√Ä Propos</span>
                </a>
            </li>
            <li>
                <a href="https://www.dawrlog.com/fr/articles/" title="Articles">
                    <span>Articles</span>
                </a>
            </li>
            <li>
                <a href="https://calendly.com/dawrlog" title="Contactez-nous">
                    <span>Contactez-nous</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://www.dawrlog.com/fr/">Accueil</a>&nbsp;¬ª&nbsp;<a href="https://www.dawrlog.com/fr/articles/">Articles</a></div>
    <h1 class="post-title">
      Les 10 optimales workflows Argo; avec examples.
    </h1>
    <div class="post-meta"><span title='2022-07-12 00:00:00 +0000 UTC'>juillet 12, 2022</span>&nbsp;¬∑&nbsp;11 min&nbsp;¬∑&nbsp;Daniel Paes

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://user-images.githubusercontent.com/78096758/217081520-1f3b6771-8cf8-434b-b8fe-d11c17d380b5.png" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table des mati√®res</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#h2configuration-des-workflows-argoh2br-"><h2>Configuration des Workflows Argo</h2><br /></a></li>
    <li><a href="#h21-am√©liorer-votre-flux-de-travail-√†-laide-de-param√®tresh2br-"><h2>1. Am√©liorer votre flux de travail √† l&rsquo;aide de param√®tres</h2><br /></a></li>
    <li><a href="#h22-extraire-des-images-de-votre-r√©f√©rentiel-s√©curis√©h2br-"><h2>2. Extraire des images de votre r√©f√©rentiel s√©curis√©</h2><br /></a></li>
    <li><a href="#h23-utilisation-des-conteneurs-sidecar-h2br-"><h2>3. Utilisation des conteneurs Sidecar </h2><br /></a></li>
    <li><a href="#h24-archiver-l√©tat-actuel-de-votre-workflow-sur-un-stockage-persistanth2br-br-"><h2>4. Archiver l&rsquo;√©tat actuel de votre workflow sur un stockage persistant</h2><br /><br /></a></li>
    <li><a href="#h25-passer-un-d√©p√¥t-git-comme-artefact-dentr√©eh2br-"><h2>5. Passer un d√©p√¥t Git comme artefact d&rsquo;entr√©e</h2><br /></a></li>
    <li><a href="#h26-cr√©ation-de-flux-de-travail-de-graphes-acycliques-dirig√©sh2br-br-"><h2>6. cr√©ation de flux de travail de graphes acycliques dirig√©s</h2><br /><br /></a></li>
    <li><a href="#h27-ex√©cuter-des-scripts-pythonh2br-br-"><h2>7. ex√©cuter des scripts Python</h2><br /><br /></a></li>
    <li><a href="#h28-impl√©mentation-dune-strat√©gie-de-relanceh2br-"><h2>8. impl√©mentation d&rsquo;une strat√©gie de relance</h2><br /></a></li>
    <li><a href="#h29-ajout-de-flux-de-travail-conditionnelsh2br-"><h2>9. Ajout de flux de travail conditionnels</h2><br /></a></li>
    <li><a href="#h2-10-gestion-des-ressources-kubernetes-√†-partir-de-votre-flux-de-travail-h2br-"><h2> 10. Gestion des ressources Kubernetes √† partir de votre flux de travail </h2><br /></a></li>
    <li><a href="#h2conclusionh2br-"><h2>Conclusion</h2><br /></a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><p>Bonjour √† tous,</p>
<p>Nous savons tous comment <a href="https://argoproj.github.io/argo-workflows/">Argo Workflows</a> permet d&rsquo;orchestrer facilement des travaux parall√®les sur Kubernetes. Bien qu&rsquo;il soit le plus souvent associ√© aux projets de traitement de donn√©es et d&rsquo;ETL, il est utile pour bien d&rsquo;autres choses ! Ces 10 workflows vont changer la fa√ßon dont vous voyez cet orchestrateur Kubernetes.</p>
<p>Allons-y !</p>
<h2 id="h2configuration-des-workflows-argoh2br-"><h2>Configuration des Workflows Argo</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h2configuration-des-workflows-argoh2br-">#</a></h2>
<p>Si vous n&rsquo;avez pas actuellement de workflow en cours d&rsquo;ex√©cution, je vous sugg√®re de cr√©er votre premier Argo Workflow pour comprendre ce dont nous allons parler dans ce post. Pour ce faire, suivez les instructions <a href="https://argoproj.github.io/argo-workflows/quick-start/">ici</a> pour cr√©er un d√©ploiement local de Workflows Argo sur votre cluster. Je vous sugg√®re √©galement d&rsquo;utiliser k3d pour votre plan de contr√¥le Kubernetes local ; ce tutoriel utilise un cluster <a href="https://k3d.io/v5.3.0/#install-script">k3d</a> nomm√© argo. N&rsquo;h√©sitez pas √† reproduire la commande ci-dessous pour le cr√©er dans votre environnement :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">k3d cluster create argo
</span></span><span class="line"><span class="cl">kubectl create -n argo -f https://raw.githubusercontent.com/argoproj/argo-workflows/master/manifests/quick-start-postgres.yaml
</span></span><span class="line"><span class="cl">kubectl -n argo port-forward deployment/argo-server 2746:2746 <span class="p">&amp;</span> 
</span></span></code></pre></div><p>Maintenant, regardons notre premier exemple !</p>
<h2 id="h21-am√©liorer-votre-flux-de-travail-√†-laide-de-param√®tresh2br-"><h2>1. Am√©liorer votre flux de travail √† l&rsquo;aide de param√®tres</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h21-am√©liorer-votre-flux-de-travail-√†-laide-de-param√®tresh2br-">#</a></h2>
<p>Argo utilise des <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">custom resource definitions</a> stock√©es dans des fichiers YAML pour g√©rer ses d√©ploiements. Il n&rsquo;est donc pas n√©cessaire d&rsquo;apprendre de nouvelles sp√©cifications pour g√©rer votre infrastructure ; vous pouvez suivre le m√™me mod√®le que celui utilis√© sur vos scripts Kubernetes et <a href="https://kustomize.io/">Kustomize</a>, ce qui vous aide √† rester coh√©rent. Ci-dessous, nous pouvons voir comment utiliser les param√®tres sur vos workflows, et passer des param√®tres est pratique lorsque votre configuration utilise des valeurs d&rsquo;ex√©cution. Par cons√©quent, vous ne conna√Ætrez certains composants qu&rsquo;apr√®s les avoir cr√©√©s, comme les <a href="https://en.wikipedia.org/wiki/Access_token">jetons d&rsquo;acc√®s</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: hello-world-parameters-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: whalesay
</span></span><span class="line"><span class="cl">  arguments:
</span></span><span class="line"><span class="cl">    parameters:
</span></span><span class="line"><span class="cl">    - name: message
</span></span><span class="line"><span class="cl">      value: Message string default value 
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: whalesay
</span></span><span class="line"><span class="cl">    inputs:
</span></span><span class="line"><span class="cl">      parameters:
</span></span><span class="line"><span class="cl">      - name: message
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: docker/whalesay
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>cowsay<span class="o">]</span>
</span></span><span class="line"><span class="cl">      args: <span class="o">[</span><span class="s2">&#34;{{inputs.parameters.message}}&#34;</span><span class="o">]</span> 
</span></span></code></pre></div><p>Dans notre mod√®le, le param√®tre <code>message</code> aura la valeur par d√©faut de <code>Message string default value</code>. Cependant, cette valeur peut √™tre √©cras√©e au moment de l&rsquo;ex√©cution, comme nous pouvons le voir en ex√©cutant la commande ci-dessous :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">argo submit -n argo param.yml -p <span class="nv">message</span><span class="o">=</span><span class="s2">&#34;This ran from your container&#34;</span> --watch 
</span></span></code></pre></div><p>Nous pouvons valider la sortie √† partir de l&rsquo;interface utilisateur des logs des workflows Argo. (Vous pouvez acc√©der √† l&rsquo;IU par d√©faut √† <code>https://localhost:2746/</code> si vous suivez rapidement les instructions de transfert de port lors de la cr√©ation de votre cluster).</p>
<h2 id="h22-extraire-des-images-de-votre-r√©f√©rentiel-s√©curis√©h2br-"><h2>2. Extraire des images de votre r√©f√©rentiel s√©curis√©</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h22-extraire-des-images-de-votre-r√©f√©rentiel-s√©curis√©h2br-">#</a></h2>
<p>L&rsquo;une des fonctionnalit√©s que j&rsquo;appr√©cie lors de l&rsquo;automatisation d&rsquo;un √©cosyst√®me est l&rsquo;utilisation de cl√©s d&rsquo;acc√®s rotatives tout en g√©rant l&rsquo;acc√®s de mes services. Ceci est utile dans les cas o√π votre entreprise utilise des d√©p√¥ts de conteneurs priv√©s pour h√©berger vos images de conteneurs. Les workflows Argo vous aident √† r√©aliser cela gr√¢ce au support natif des secrets Kubernetes. Dans notre exemple, nous pouvons voir que le secret <code>docker-registry-secret</code> va tirer l&rsquo;image <code>docker/whalesay:latest</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: hello-world-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: whalesay
</span></span><span class="line"><span class="cl">  imagePullSecrets:
</span></span><span class="line"><span class="cl">  - name: docker-registry-secret
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: whalesay
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: docker/whalesay:latest
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>cowsay<span class="o">]</span>
</span></span><span class="line"><span class="cl">      args: <span class="o">[</span><span class="s2">&#34;hello world&#34;</span><span class="o">]</span> 
</span></span></code></pre></div><h2 id="h23-utilisation-des-conteneurs-sidecar-h2br-"><h2>3. Utilisation des conteneurs Sidecar </h2><br /><a hidden class="anchor" aria-hidden="true" href="#h23-utilisation-des-conteneurs-sidecar-h2br-">#</a></h2>
<p>L&rsquo;une de mes choses pr√©f√©r√©es √† faire est d&rsquo;utiliser des sidecars lors du d√©marrage de mes pods. Les sidecars Kubernetes sont des aides utiles qui peuvent g√©rer des t√¢ches r√©currentes, comme la synchronisation de vos d√©p√¥ts Git avec <code>git-sync</code> comme indiqu√© <a href="https://github.com/kubernetes/git-sync">ici</a>. Les flux de travail d&rsquo;Argo couvrent ce probl√®me avec un support soign√© des conteneurs sidecars.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: sidecar-nginx-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: sidecar-nginx-example
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: sidecar-nginx-example
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: appropriate/curl
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>sh, -c<span class="o">]</span>
</span></span><span class="line"><span class="cl">      args: <span class="o">[</span><span class="s2">&#34;until `curl -G &#39;http://127.0.0.1/&#39; &gt;&amp; /tmp/out`; do echo sleep &amp;&amp; sleep 1; done &amp;&amp; cat /tmp/out&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">    sidecars:
</span></span><span class="line"><span class="cl">    - name: nginx
</span></span><span class="line"><span class="cl">      image: nginx:1.13 
</span></span></code></pre></div><p>Pour le d√©ployer, enregistrez le code ci-dessus sous le nom de <code>sidecar-nginx.yml</code> et soumettez-le :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">argo submit -n argo sidecar-nginx.yml --watch 
</span></span></code></pre></div><p>Et comme r√©sultat, vous allez d√©ployer une instance sidecar de proxy inverse de NGINX.</p>
<p><strong><em>Pro-tip : Vous devrez peut-√™tre pr√™ter une attention particuli√®re √† vos workflows si vous utilisez <a href="https://istio.io/">Istio</a> comme Service mesh. Consultez ce fil de discussion GitHub si vous envisagez de l&rsquo;utiliser.</em></strong></p>
<h2 id="h24-archiver-l√©tat-actuel-de-votre-workflow-sur-un-stockage-persistanth2br-br-"><h2>4. Archiver l&rsquo;√©tat actuel de votre workflow sur un stockage persistant</h2><br /><br /><a hidden class="anchor" aria-hidden="true" href="#h24-archiver-l√©tat-actuel-de-votre-workflow-sur-un-stockage-persistanth2br-br-">#</a></h2>
<p>L&rsquo;archivage des workflows est une fonctionnalit√© int√©ressante fournie par Argo Workflows afin que vous puissiez avoir des √©tats de workflow pr√©c√©dents stock√©s sur une base de donn√©es relationnelle (Postgres ou MySQL pour l&rsquo;instant). Cependant, l&rsquo;archive d&rsquo;Argo ne conservera pas les journaux d&rsquo;ex√©cution d√©taill√©s ; vous devrez configurer un stockage d&rsquo;objets comme <a href="https://argoproj.github.io/argo-workflows/configure-artifact-repository/">artefact repository</a>, il peut s&rsquo;agir d&rsquo;une option opensource comme <a href="https://min.io/">MinIO</a>, ou <a href="https://aws.amazon.com/s3/">AWS S3</a> ; pour mentionner une option de fournisseur de cloud d&rsquo;AWS.</p>
<p>Pour utiliser la fonctionnalit√© d&rsquo;archivage, vous devez d&rsquo;abord configurer l&rsquo;option de stockage persistant de votre serveur Argo. Pour ce faire, vous aurez besoin de plus d&rsquo;informations sur la fa√ßon de la configurer. En suivant ce lien, vous pourrez vous familiariser avec les √©l√©ments d&rsquo;authentification requis pour l&rsquo;archive Argo ; puis, basez votre configuration sur <a href="https://argoproj.github.io/argo-workflows/workflow-controller-configmap/">Controller configmap</a>. Vous devrez les avoir configur√©s de mani√®re appropri√©e avec votre serveur Argo pour b√©n√©ficier de cette fonctionnalit√©. Une fois qu&rsquo;il est configur√©, vous pouvez stocker vos flux de travail avec le <code>spec.archiveLocation.archiveLogs</code> comme d√©montr√© ci-dessous.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: archive-location-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: whalesay
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: whalesay
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: docker/whalesay:latest
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>cowsay<span class="o">]</span>
</span></span><span class="line"><span class="cl">      args: <span class="o">[</span><span class="s2">&#34;hello world&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">    archiveLocation:
</span></span><span class="line"><span class="cl">      archiveLogs: <span class="nb">true</span> 
</span></span></code></pre></div><h2 id="h25-passer-un-d√©p√¥t-git-comme-artefact-dentr√©eh2br-"><h2>5. Passer un d√©p√¥t Git comme artefact d&rsquo;entr√©e</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h25-passer-un-d√©p√¥t-git-comme-artefact-dentr√©eh2br-">#</a></h2>
<p>Une autre fonctionnalit√© int√©ressante fournie par Argo Workflows est la possibilit√© de synchroniser votre d√©p√¥t Git sans avoir besoin de sidecars ou de conteneurs init suppl√©mentaires. Le code ci-dessous se connecte au <a href="https://github.com/argoproj/argo-workflows.git">d√©p√¥t Argo</a> sur Github.
Vous pouvez choisir entre des demandes de pull HTTP ou SSH pour l&rsquo;√©l√©ment d&rsquo;authentification. Dans le premier mod√®le, git-clone, vous devrez utiliser la combinaison des secrets Kubernetes usernameSecret et passwordSecret pour acc√©der √† une URL dans son format HTTP. Vous pouvez voir un exemple de configuration HTTP de Git dans le code ci-dessous.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: input-artifact-git-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: git-clone
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: git-clone
</span></span><span class="line"><span class="cl">    inputs:
</span></span><span class="line"><span class="cl">      artifacts:
</span></span><span class="line"><span class="cl">      - name: argo-source
</span></span><span class="line"><span class="cl">        path: /src
</span></span><span class="line"><span class="cl">        git:
</span></span><span class="line"><span class="cl">          repo: https://github.com/argoproj/argo-workflows.git
</span></span><span class="line"><span class="cl">          revision: <span class="s2">&#34;v2.1.1&#34;</span>
</span></span><span class="line"><span class="cl">          usernameSecret:
</span></span><span class="line"><span class="cl">            name: github-creds
</span></span><span class="line"><span class="cl">            key: username
</span></span><span class="line"><span class="cl">          passwordSecret:
</span></span><span class="line"><span class="cl">            name: github-creds
</span></span><span class="line"><span class="cl">            key: password
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: golang:1.10
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>sh, -c<span class="o">]</span>
</span></span><span class="line"><span class="cl">      args: <span class="o">[</span><span class="s2">&#34;git status &amp;&amp; ls &amp;&amp; cat VERSION&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">      workingDir: /src 
</span></span></code></pre></div><p>Argo Workflows supporte √©galement la connectivit√© SSH (e.g., <code>git@github.com:argoproj/argo-workflows.git</code>). Cependant, il a besoin du format d&rsquo;URL suivant la connectivit√© SSH et du secret Kubernetes <code>sshPrivateKeySecret</code> au lieu des secrets <code>usernameSecret</code> et <code>passwordSecret</code>.
<br /></p>
<h2 id="h26-cr√©ation-de-flux-de-travail-de-graphes-acycliques-dirig√©sh2br-br-"><h2>6. cr√©ation de flux de travail de graphes acycliques dirig√©s</h2><br /><br /><a hidden class="anchor" aria-hidden="true" href="#h26-cr√©ation-de-flux-de-travail-de-graphes-acycliques-dirig√©sh2br-br-">#</a></h2>
<p>J&rsquo;ai l&rsquo;impression que le graphe acyclique dirig√© (DAG) re√ßoit maintenant l&rsquo;attention qu&rsquo;il m√©rite dans les domaines de l&rsquo;analyse en raison de la fa√ßon impressionnante dont il g√®re les √©tapes de la charge de travail de traitement des donn√©es sur <a href="https://spark.apache.org/docs/3.2.1/index.html">Apache Spark</a> et de son utilisation comme mod√®le commun d&rsquo;orchestration des donn√©es avec Apache Airflow. Avec Argo Workflows, vous disposerez d&rsquo;une interface conviviale Kubernetes au lieu de devoir configurer un ex√©cuteur Kubernetes pour Airflow qui est moins stable.</p>
<p>Je vous sugg√®re de consulter ce <a href="https://www.techopedia.com/definition/5739/directed-acyclic-graph-dag">lien</a> pour en savoir plus sur le fonctionnement d&rsquo;un DAG. Ci-dessous, vous pouvez voir comment Argo Workflows l&rsquo;instancie.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: dag-target-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: dag-target
</span></span><span class="line"><span class="cl">  arguments:
</span></span><span class="line"><span class="cl">    parameters:
</span></span><span class="line"><span class="cl">    - name: target
</span></span><span class="line"><span class="cl">      value: E
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: dag-target
</span></span><span class="line"><span class="cl">    dag:
</span></span><span class="line"><span class="cl">      target: <span class="s2">&#34;{{workflow.parameters.target}}&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      tasks:
</span></span><span class="line"><span class="cl">      - name: A
</span></span><span class="line"><span class="cl">        template: <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">        arguments:
</span></span><span class="line"><span class="cl">          parameters: <span class="o">[{</span>name: message, value: A<span class="o">}]</span>
</span></span><span class="line"><span class="cl">      - name: B
</span></span><span class="line"><span class="cl">        depends: <span class="s2">&#34;A&#34;</span>
</span></span><span class="line"><span class="cl">        template: <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">        arguments:
</span></span><span class="line"><span class="cl">          parameters: <span class="o">[{</span>name: message, value: B<span class="o">}]</span>
</span></span><span class="line"><span class="cl">      - name: C
</span></span><span class="line"><span class="cl">        depends: <span class="s2">&#34;A&#34;</span>
</span></span><span class="line"><span class="cl">        template: <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">        arguments:
</span></span><span class="line"><span class="cl">          parameters: <span class="o">[{</span>name: message, value: C<span class="o">}]</span>
</span></span><span class="line"><span class="cl">      - name: D
</span></span><span class="line"><span class="cl">        depends: <span class="s2">&#34;B &amp;&amp; C&#34;</span>
</span></span><span class="line"><span class="cl">        template: <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">        arguments:
</span></span><span class="line"><span class="cl">          parameters: <span class="o">[{</span>name: message, value: D<span class="o">}]</span>
</span></span><span class="line"><span class="cl">      - name: E
</span></span><span class="line"><span class="cl">        depends: <span class="s2">&#34;C&#34;</span>
</span></span><span class="line"><span class="cl">        template: <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">        arguments:
</span></span><span class="line"><span class="cl">          parameters: <span class="o">[{</span>name: message, value: E<span class="o">}]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  - name: <span class="nb">echo</span>
</span></span><span class="line"><span class="cl">    inputs:
</span></span><span class="line"><span class="cl">      parameters:
</span></span><span class="line"><span class="cl">      - name: message
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: alpine:3.7
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>echo, <span class="s2">&#34;{{inputs.parameters.message}}&#34;</span><span class="o">]</span> 
</span></span></code></pre></div><p>Chaque t√¢che sera pass√©e au serveur Argo en utilisant le nom du param√®tre <code>target</code>, avec les noms des cibles s√©par√©s par des espaces. Les workflows Argo n&rsquo;ex√©cuteront que celles que vous avez sp√©cifi√©es ; cependant, ils ex√©cuteront chaque d√©pendance jusqu&rsquo;√† ce qu&rsquo;elle atteigne les cibles renseign√©es. En clair, disons que nous enregistrons notre fichier sous le nom de <code>dag-targets.yml</code> et l&rsquo;ex√©cutons en utilisant la commande suivante :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">argo submit -n argo dag-targets.yml -p <span class="nv">target</span><span class="o">=</span><span class="s2">&#34;B E&#34;</span> --watch
</span></span></code></pre></div><p>Il ignorera uniquement la <strong>cible D</strong>, comme le montre la d√©monstration ci-dessous :</p>
<h2 id="h27-ex√©cuter-des-scripts-pythonh2br-br-"><h2>7. ex√©cuter des scripts Python</h2><br /><br /><a hidden class="anchor" aria-hidden="true" href="#h27-ex√©cuter-des-scripts-pythonh2br-br-">#</a></h2>
<p>Les conteneurs facilitent d√©j√† la gestion des environnements d&rsquo;ex√©cution. Il est donc facile de construire un conteneur Python avec les biblioth√®ques et la version dont vous avez besoin pour vos √©tapes de workflow bas√©es sur Python.</p>
<p>Avec les workflows Argo, vous pouvez appeler un script Python d√©j√† install√© sur le conteneur par son nom, ou passer du code via un champ <code>source</code> dans la description du workflow. Vous pouvez sp√©cifier n&rsquo;importe quel code valide dans le bloc source.</p>
<p>Voici un exemple :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  name: python-random-number-generator
</span></span><span class="line"><span class="cl">  namespace: argo
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: generator
</span></span><span class="line"><span class="cl">  arguments:
</span></span><span class="line"><span class="cl">    parameters:
</span></span><span class="line"><span class="cl">      - name: min
</span></span><span class="line"><span class="cl">        value: <span class="m">0</span>
</span></span><span class="line"><span class="cl">      - name: max
</span></span><span class="line"><span class="cl">        value: <span class="m">10</span>
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: generator
</span></span><span class="line"><span class="cl">    inputs:
</span></span><span class="line"><span class="cl">      parameters:
</span></span><span class="line"><span class="cl">        - name: min
</span></span><span class="line"><span class="cl">        - name: max
</span></span><span class="line"><span class="cl">    script:
</span></span><span class="line"><span class="cl">      image: python:3.8
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span>python<span class="o">]</span>
</span></span><span class="line"><span class="cl">      source: <span class="p">|</span>
</span></span><span class="line"><span class="cl">        from random import randrange
</span></span><span class="line"><span class="cl">        <span class="nv">range_min</span> <span class="o">=</span> <span class="o">{{</span>inputs.parameters.min<span class="o">}}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">range_max</span> <span class="o">=</span> <span class="o">{{</span>inputs.parameters.max<span class="o">}}</span>
</span></span><span class="line"><span class="cl">        <span class="nv">random_number</span> <span class="o">=</span> randrange<span class="o">(</span>range_min, range_max<span class="o">)</span>
</span></span><span class="line"><span class="cl">        print<span class="o">(</span><span class="s2">&#34;Random number: {}&#34;</span>.format<span class="o">(</span>random_number<span class="o">))</span> 
</span></span></code></pre></div><h2 id="h28-impl√©mentation-dune-strat√©gie-de-relanceh2br-"><h2>8. impl√©mentation d&rsquo;une strat√©gie de relance</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h28-impl√©mentation-dune-strat√©gie-de-relanceh2br-">#</a></h2>
<p>Parfois, plusieurs cibles peuvent impl√©menter une certaine logique de relance, et Argo Workflows configure votre <a href="https://argoproj.github.io/argo-workflows/retries/">strat√©gie de relance</a> au niveau du Workflow.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: retry-container-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: retry-container
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: retry-container
</span></span><span class="line"><span class="cl">    retryStrategy:
</span></span><span class="line"><span class="cl">      limit: <span class="s2">&#34;3&#34;</span>
</span></span><span class="line"><span class="cl">      retryPolicy: <span class="s2">&#34;OnError&#34;</span>
</span></span><span class="line"><span class="cl">    container:
</span></span><span class="line"><span class="cl">      image: python:alpine3.6
</span></span><span class="line"><span class="cl">      command: <span class="o">[</span><span class="s2">&#34;python&#34;</span>, -c<span class="o">]</span>
</span></span><span class="line"><span class="cl">      <span class="c1"># fail with a 66% probability</span>
</span></span><span class="line"><span class="cl">      args: <span class="o">[</span><span class="s2">&#34;import random; import sys; exit_code = random.choice([0, 1, 1]); sys.exit(exit_code)&#34;</span><span class="o">]</span> 
</span></span></code></pre></div><p>Dans notre exemple, la cible <code>retry-container</code> essaiera de red√©marrer trois fois dans les cas o√π elle se termine avec un statut Error sur Kubernetes.</p>
<h2 id="h29-ajout-de-flux-de-travail-conditionnelsh2br-"><h2>9. Ajout de flux de travail conditionnels</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h29-ajout-de-flux-de-travail-conditionnelsh2br-">#</a></h2>
<p>Les flux de travail conditionnels font √©galement partie de mes pr√©f√©r√©s et sont si simples √† mettre en ≈ìuvre. Vous pouvez d√©ployer votre architecture en fonction des √©tats de retour des √©tapes pr√©c√©dentes, ce qui est tr√®s pratique lorsque vous orchestrez un ensemble de conteneurs. Argo Workflows vous offre la possibilit√© d&rsquo;ex√©cuter des cibles bas√©es sur une condition bool√©enne. Sous le capot, il utilise <a href="https://github.com/Knetic/govaluate">govaluate</a> pour vous permettre d&rsquo;utiliser <a href="https://github.com/antonmedv/expr">les instructions expr de Golang</a>.</p>
<p>Vous serez donc en mesure d&rsquo;orchestrer vos conditions de la m√™me mani√®re que vous g√©rez vos aides Golang dans votre √©cosyst√®me Kubernetes - un autre avantage suppl√©mentaire de l&rsquo;utilisation des CRD Kubernetes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: conditional-parameter-
</span></span><span class="line"><span class="cl">  labels:
</span></span><span class="line"><span class="cl">    workflows.argoproj.io/test: <span class="s2">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">  annotations:
</span></span><span class="line"><span class="cl">    workflows.argoproj.io/version: <span class="s1">&#39;&gt;= 3.1.0&#39;</span>
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: main
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">    - name: main
</span></span><span class="line"><span class="cl">      steps:
</span></span><span class="line"><span class="cl">        - - name: flip-coin
</span></span><span class="line"><span class="cl">            template: flip-coin
</span></span><span class="line"><span class="cl">        - - name: heads
</span></span><span class="line"><span class="cl">            template: heads
</span></span><span class="line"><span class="cl">            when: <span class="s2">&#34;{{steps.flip-coin.outputs.result}} == heads&#34;</span>
</span></span><span class="line"><span class="cl">          - name: tails
</span></span><span class="line"><span class="cl">            template: tails
</span></span><span class="line"><span class="cl">            when: <span class="s2">&#34;{{steps.flip-coin.outputs.result}} == tails&#34;</span>
</span></span><span class="line"><span class="cl">      outputs:
</span></span><span class="line"><span class="cl">        parameters:
</span></span><span class="line"><span class="cl">          - name: stepresult
</span></span><span class="line"><span class="cl">            valueFrom:
</span></span><span class="line"><span class="cl">              expression: <span class="s2">&#34;steps[&#39;flip-coin&#39;].outputs.result == &#39;heads&#39; ? steps.heads.outputs.result : steps.tails.outputs.result&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    - name: flip-coin
</span></span><span class="line"><span class="cl">      script:
</span></span><span class="line"><span class="cl">        image: python:alpine3.6
</span></span><span class="line"><span class="cl">        command: <span class="o">[</span> python <span class="o">]</span>
</span></span><span class="line"><span class="cl">        source: <span class="p">|</span>
</span></span><span class="line"><span class="cl">          import random
</span></span><span class="line"><span class="cl">          print<span class="o">(</span><span class="s2">&#34;heads&#34;</span> <span class="k">if</span> random.randint<span class="o">(</span>0,1<span class="o">)</span> <span class="o">==</span> <span class="m">0</span> <span class="k">else</span> <span class="s2">&#34;tails&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    - name: heads
</span></span><span class="line"><span class="cl">      script:
</span></span><span class="line"><span class="cl">        image: python:alpine3.6
</span></span><span class="line"><span class="cl">        command: <span class="o">[</span> python <span class="o">]</span>
</span></span><span class="line"><span class="cl">        source: <span class="p">|</span>
</span></span><span class="line"><span class="cl">          print<span class="o">(</span><span class="s2">&#34;heads&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    - name: tails
</span></span><span class="line"><span class="cl">      script:
</span></span><span class="line"><span class="cl">        image: python:alpine3.6
</span></span><span class="line"><span class="cl">        command: <span class="o">[</span> python <span class="o">]</span>
</span></span><span class="line"><span class="cl">        source: <span class="p">|</span>
</span></span><span class="line"><span class="cl">          print<span class="o">(</span><span class="s2">&#34;tails&#34;</span><span class="o">)</span> 
</span></span></code></pre></div><p>En enregistrant le code ci-dessus sous le nom de <code>cond.yml</code> et en l&rsquo;ex√©cutant avec <code>argo submit</code>, vous obtiendrez le r√©sultat suivant :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">argo submit -n argo cond.yml --watch 
</span></span></code></pre></div><br />
<p><img loading="lazy" src="https://user-images.githubusercontent.com/78096758/217082060-b565c064-74fb-457a-b7ae-6035e81019bb.png#center" alt="Argo Workflows conditional execution results"  />
</p>
<h2 id="h2-10-gestion-des-ressources-kubernetes-√†-partir-de-votre-flux-de-travail-h2br-"><h2> 10. Gestion des ressources Kubernetes √† partir de votre flux de travail </h2><br /><a hidden class="anchor" aria-hidden="true" href="#h2-10-gestion-des-ressources-kubernetes-√†-partir-de-votre-flux-de-travail-h2br-">#</a></h2>
<p>Les workflows Argo peuvent cr√©er des composants Kubernetes ; ceci est tr√®s pratique lorsque vous avez besoin de d√©velopper des actions kubelet temporaires de mani√®re d√©clarative. Cette fonctionnalit√© suit le m√™me principe que les scripts en ligne pour d√©ployer les composants Kubernetes responsables de l&rsquo;application des correctifs √† votre environnement. Cependant, Argo Workflows g√®re les fichiers YAML en ligne de ce code <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/#customresourcedefinitions">Kubernetes CRD</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">apiVersion: argoproj.io/v1alpha1
</span></span><span class="line"><span class="cl">kind: Workflow
</span></span><span class="line"><span class="cl">metadata:
</span></span><span class="line"><span class="cl">  generateName: k8s-jobs-
</span></span><span class="line"><span class="cl">spec:
</span></span><span class="line"><span class="cl">  entrypoint: pi-tmpl
</span></span><span class="line"><span class="cl">  templates:
</span></span><span class="line"><span class="cl">  - name: pi-tmpl
</span></span><span class="line"><span class="cl">    resource:                  
</span></span><span class="line"><span class="cl">      action: create           
</span></span><span class="line"><span class="cl">      successCondition: status.succeeded &gt; <span class="m">0</span>
</span></span><span class="line"><span class="cl">      failureCondition: status.failed &gt; <span class="m">3</span>
</span></span><span class="line"><span class="cl">      manifest: <span class="p">|</span>               
</span></span><span class="line"><span class="cl">        apiVersion: batch/v1
</span></span><span class="line"><span class="cl">        kind: Job
</span></span><span class="line"><span class="cl">        metadata:
</span></span><span class="line"><span class="cl">          generateName: pi-job-
</span></span><span class="line"><span class="cl">        spec:
</span></span><span class="line"><span class="cl">          template:
</span></span><span class="line"><span class="cl">            metadata:
</span></span><span class="line"><span class="cl">              name: pi
</span></span><span class="line"><span class="cl">            spec:
</span></span><span class="line"><span class="cl">              containers:
</span></span><span class="line"><span class="cl">              - name: pi
</span></span><span class="line"><span class="cl">                image: perl
</span></span><span class="line"><span class="cl">                command: <span class="o">[</span><span class="s2">&#34;perl&#34;</span>,  <span class="s2">&#34;-Mbignum=bpi&#34;</span>, <span class="s2">&#34;-wle&#34;</span>, <span class="s2">&#34;print bpi(2000)&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">              restartPolicy: Never
</span></span><span class="line"><span class="cl">          backoffLimit: <span class="m">4</span> 
</span></span></code></pre></div><p>Cette fonctionnalit√© vous permet d&rsquo;ex√©cuter directement toutes les actions kubectl, ce qui vous permet de cr√©er/mettre √† jour/supprimer n&rsquo;importe quelle ressource Kubernetes sur votre cluster en utilisant les d√©finitions en ligne des <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.23/">groupes API Kubernetes</a>.</p>
<h2 id="h2conclusionh2br-"><h2>Conclusion</h2><br /><a hidden class="anchor" aria-hidden="true" href="#h2conclusionh2br-">#</a></h2>
<p>Les progr√®s r√©alis√©s dans la gestion et le d√©veloppement des syst√®mes nous donnent de nombreuses raisons d&rsquo;√™tre optimistes. Par exemple, <a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">infrastructure as code</a> vous permet d&rsquo;avoir la m√™me infrastructure sur vos serveurs √©volutifs et sur votre poste de travail local. Des outils tels que Argo Workflows nous aident √† cr√©er une infrastructure √©volutive pr√™te √† √™tre mise en production sur notre poste de travail local, ce qui est en soi une bonne chose.</p>
<p>Avec les changements constants des exigences de l&rsquo;infrastructure comme le <a href="https://en.wikipedia.org/wiki/Dynamic_DNS#:~:text=Dynamic%20DNS%20(DDNS)%20is%20a,hostnames%2C%20adresses%20ou%20autres%20informations.">DNS dynamique</a>, vous devez adapter vos d√©ploiements √† une approche plus modulaire. Ces flux de travail sont les incontournables de tout administrateur DevOps. Mais cette liste n&rsquo;est qu&rsquo;un d√©but. Je vous conseille vivement de mettre en ≈ìuvre ces scripts dans vos pipelines de d√©veloppement et de donn√©es.</p>
<p>√Ä+!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://www.dawrlog.com/fr/articles/5/">
    <span class="title">¬´ Page pr√©c√©dente</span>
    <br>
    <span>Examples des ETL utilisant des workflows Argo.</span>
  </a>
  <a class="next" href="https://www.dawrlog.com/fr/articles/4/">
    <span class="title">Page suivante ¬ª</span>
    <br>
    <span>Moyens de debug un workflow Argo.</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Les 10 optimales workflows Argo; avec examples. on twitter"
        href="https://twitter.com/intent/tweet/?text=Les%2010%20optimales%20workflows%20Argo%3b%20avec%20examples.&amp;url=https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f&amp;hashtags=Kubernetes%2cArgo%2cDevelopment%2cInfrastructureObservability">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Les 10 optimales workflows Argo; avec examples. on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f&amp;title=Les%2010%20optimales%20workflows%20Argo%3b%20avec%20examples.&amp;summary=Les%2010%20optimales%20workflows%20Argo%3b%20avec%20examples.&amp;source=https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Les 10 optimales workflows Argo; avec examples. on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f&title=Les%2010%20optimales%20workflows%20Argo%3b%20avec%20examples.">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Les 10 optimales workflows Argo; avec examples. on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Les 10 optimales workflows Argo; avec examples. on whatsapp"
        href="https://api.whatsapp.com/send?text=Les%2010%20optimales%20workflows%20Argo%3b%20avec%20examples.%20-%20https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Les 10 optimales workflows Argo; avec examples. on telegram"
        href="https://telegram.me/share/url?text=Les%2010%20optimales%20workflows%20Argo%3b%20avec%20examples.&amp;url=https%3a%2f%2fwww.dawrlog.com%2ffr%2farticles%2f6%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://www.dawrlog.com/fr/">Logistique Dataware</a>; <br /> created with üß° on üêß machines running ‚ò∏Ô∏è pods.</span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script src='https://storage.ko-fi.com/cdn/scripts/overlay-widget.js'></script>
<script>
  kofiWidgetOverlay.draw('dawrlog', {
    'type': 'floating-chat',
    'floating-chat.donateButton.text': 'Tip jar',
    'floating-chat.donateButton.background-color': '#794bc4',
    'floating-chat.donateButton.text-color': '#fff'
  });
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'Copier';

        function copyingDone() {
            copybutton.innerHTML = 'Copi√© !';
            setTimeout(() => {
                copybutton.innerHTML = 'Copier';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
